<div class="edit-profile-modal">
  <div class="modal-header">
    <h2>
      <mat-icon>edit</mat-icon>
      Modifier le Profil
    </h2>
    <button mat-icon-button (click)="dialogRef.close()" class="close-btn">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <form [formGroup]="profileForm" (ngSubmit)="saveChanges()">
    <!-- Avatar Section -->
    <div class="avatar-section">
      <div class="avatar-container">
        <img [src]="selectedFile || profilePicture || 'https://placehold.co/120x120'" class="avatar-preview" alt="Avatar">
        <div class="avatar-overlay" (click)="fileInput.click()">
          <mat-icon>camera_alt</mat-icon>
          <span>Changer</span>
        </div>
        <input #fileInput type="file" accept="image/*" (change)="onFileSelected($event)" hidden>
      </div>
      <div class="avatar-info">
        <p class="avatar-title">Photo de profil</p>
        <p class="avatar-hint">Cliquez pour changer votre avatar</p>
      </div>
    </div>

    <!-- Section: Informations de base -->
    <div class="form-section">
      <h3 class="section-title">
        <mat-icon>person</mat-icon>
        Informations de base
      </h3>
      <div class="form-grid">
        <mat-form-field appearance="outline">
          <mat-label>Pseudo</mat-label>
          <input matInput formControlName="pseudo" required>
          <mat-icon matPrefix>alternate_email</mat-icon>
          <mat-error>Le pseudo est requis</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Email</mat-label>
          <input matInput formControlName="email" type="email">
          <mat-icon matPrefix>email</mat-icon>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Prénom</mat-label>
          <input matInput formControlName="firstName">
          <mat-icon matPrefix>badge</mat-icon>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Nom</mat-label>
          <input matInput formControlName="lastName">
          <mat-icon matPrefix>badge</mat-icon>
        </mat-form-field>
      </div>
    </div>

    <!-- Section: Profil professionnel -->
    <div class="form-section">
      <h3 class="section-title">
        <mat-icon>work</mat-icon>
        Profil professionnel
      </h3>
      <div class="form-grid">
        <mat-form-field appearance="outline">
          <mat-label>Métier</mat-label>
          <mat-select formControlName="job">
            <mat-option value="">Non renseigné</mat-option>
            @for (job of jobOptions; track job.value) {
              <mat-option [value]="job.value">{{ job.label }}</mat-option>
            }
          </mat-select>
          <mat-icon matPrefix>code</mat-icon>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Expérience</mat-label>
          <mat-select formControlName="experience">
            <mat-option value="">Non renseigné</mat-option>
            @for (exp of experienceOptions; track exp.value) {
              <mat-option [value]="exp.value">{{ exp.label }}</mat-option>
            }
          </mat-select>
          <mat-icon matPrefix>timeline</mat-icon>
        </mat-form-field>
      </div>
    </div>

    <!-- Section: Informations optionnelles -->
    <div class="form-section">
      <h3 class="section-title">
        <mat-icon>info</mat-icon>
        Informations optionnelles
        <span class="section-hint">(pour les statistiques anonymes)</span>
      </h3>
      <div class="form-grid">
        <mat-form-field appearance="outline">
          <mat-label>Tranche de salaire</mat-label>
          <mat-select formControlName="salaryRange">
            <mat-option value="">Non renseigné</mat-option>
            @for (salary of salaryOptions; track salary.value) {
              <mat-option [value]="salary.value">{{ salary.label }}</mat-option>
            }
          </mat-select>
          <mat-icon matPrefix>payments</mat-icon>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Tranche d'âge</mat-label>
          <mat-select formControlName="ageRange">
            <mat-option value="">Non renseigné</mat-option>
            @for (age of ageOptions; track age.value) {
              <mat-option [value]="age.value">{{ age.label }}</mat-option>
            }
          </mat-select>
          <mat-icon matPrefix>cake</mat-icon>
        </mat-form-field>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="modal-actions">
      <button mat-stroked-button type="button" (click)="dialogRef.close()">
        <mat-icon>close</mat-icon>
        Annuler
      </button>
      <button mat-raised-button color="primary" type="submit" [disabled]="!profileForm.valid">
        <mat-icon>save</mat-icon>
        Enregistrer
      </button>
    </div>
  </form>
</div>
