<div class="subscription-page">
  <!-- Space background -->
  <div class="space-background">
    <div class="stars"></div>
    <div class="stars2"></div>
    <div class="stars3"></div>
    <div class="nebula"></div>
  </div>

  <div class="subscription-content">
    @if (isLoading) {
      <div class="loading-container">
        <div class="cyber-loader">
          <span class="loader-text">CHARGEMENT</span>
          <div class="loader-bar">
            <div class="loader-fill"></div>
          </div>
        </div>
      </div>
    } @else {
      <!-- Header -->
      <div class="page-header">
        <div class="terminal-prompt">
          <span class="prompt-symbol">$</span>
          <span class="prompt-command">subscription --status</span>
        </div>
        <h1 class="cyber-title" data-text="PREMIUM">
          <span class="glitch">PREMIUM</span>
        </h1>
        <p class="cyber-subtitle">DÃ©bloquez une expÃ©rience sans limites</p>
      </div>

      <!-- Not subscribed -->
      @if (!isSubscriber) {
        <div class="pricing-section">
          <!-- Pricing Card -->
          <div class="cyber-card pricing-card">
            <div class="card-glow"></div>
            <div class="card-header">
              <div class="plan-badge">
                <span class="badge-icon">â—†</span>
                <span class="badge-text">PREMIUM</span>
              </div>
              <div class="price-display">
                <span class="price-currency">â‚¬</span>
                <span class="price-amount">0,99</span>
                <span class="price-period">/mois</span>
              </div>
            </div>

            <div class="card-divider">
              <span class="divider-line"></span>
              <span class="divider-icon">â¬¡</span>
              <span class="divider-line"></span>
            </div>

            <div class="benefits-list">
              <div class="benefit-item">
                <span class="benefit-icon">â–¹</span>
                <span class="benefit-text">Navigation sans publicitÃ©</span>
                <span class="benefit-check">âœ“</span>
              </div>
              <div class="benefit-item">
                <span class="benefit-icon">â–¹</span>
                <span class="benefit-text">ExpÃ©rience fluide et rapide</span>
                <span class="benefit-check">âœ“</span>
              </div>
              <div class="benefit-item">
                <span class="benefit-icon">â–¹</span>
                <span class="benefit-text">Soutien au dÃ©veloppement</span>
                <span class="benefit-check">âœ“</span>
              </div>
              <div class="benefit-item">
                <span class="benefit-icon">â–¹</span>
                <span class="benefit-text">Annulable Ã  tout moment</span>
                <span class="benefit-check">âœ“</span>
              </div>
            </div>

            <div class="card-footer">
              <div class="renewal-info">
                <span class="info-icon">â„¹</span>
                <span class="info-text">Renouvellement automatique mensuel</span>
              </div>

              <button
                class="cyber-btn primary"
                (click)="subscribe()"
                [disabled]="isProcessing"
                [class.processing]="isProcessing">
                @if (isProcessing) {
                  <span class="btn-loader"></span>
                  <span class="btn-text">TRAITEMENT...</span>
                } @else {
                  <span class="btn-icon">âš¡</span>
                  <span class="btn-text">S'ABONNER</span>
                }
                <span class="btn-shine"></span>
              </button>
            </div>
          </div>

          <!-- Features highlight -->
          <div class="features-grid">
            <div class="feature-card">
              <div class="feature-icon">ðŸš«</div>
              <div class="feature-title">ZERO PUB</div>
              <div class="feature-desc">Aucune distraction</div>
            </div>
            <div class="feature-card">
              <div class="feature-icon">âš¡</div>
              <div class="feature-title">RAPIDE</div>
              <div class="feature-desc">Chargement optimisÃ©</div>
            </div>
            <div class="feature-card">
              <div class="feature-icon">ðŸ’Ž</div>
              <div class="feature-title">PREMIUM</div>
              <div class="feature-desc">ExpÃ©rience exclusive</div>
            </div>
          </div>
        </div>
      }

      <!-- Already subscribed -->
      @if (isSubscriber && subscription) {
        <div class="active-subscription">
          <div class="cyber-card status-card">
            <div class="card-glow active"></div>

            <div class="status-header">
              <div class="status-badge" [class]="subscription.status">
                <span class="status-dot"></span>
                <span class="status-label">
                  {{ subscription.status === 'active' ? 'ACTIF' : 'ANNULÃ‰' }}
                </span>
              </div>
              <div class="plan-info">
                <span class="plan-name">PREMIUM</span>
                <span class="plan-price">{{ formatPrice(subscription.amount) }}/mois</span>
              </div>
            </div>

            <div class="card-divider">
              <span class="divider-line"></span>
              <span class="divider-icon">â¬¡</span>
              <span class="divider-line"></span>
            </div>

            <div class="subscription-details">
              <div class="detail-row">
                <span class="detail-label">
                  <span class="label-icon">â–¸</span>
                  Date de dÃ©but
                </span>
                <span class="detail-value">{{ subscription.startDate | date: 'dd/MM/yyyy' }}</span>
              </div>
              <div class="detail-row">
                <span class="detail-label">
                  <span class="label-icon">â–¸</span>
                  Prochaine Ã©chÃ©ance
                </span>
                <span class="detail-value">{{ subscriptionEndDate }}</span>
              </div>
              @if (subscription.autoRenew && subscription.status === 'active') {
                <div class="detail-row">
                  <span class="detail-label">
                    <span class="label-icon">â–¸</span>
                    Prochain paiement
                  </span>
                  <span class="detail-value highlight">
                    {{ subscription.nextBillingDate | date: 'dd/MM/yyyy' }} - {{ formatPrice(subscription.amount) }}
                  </span>
                </div>
              }
            </div>

            <div class="active-benefit">
              <span class="benefit-icon-large">âœ“</span>
              <span class="benefit-message">Vous bÃ©nÃ©ficiez d'une expÃ©rience sans publicitÃ©</span>
            </div>

            <div class="card-actions">
              @if (subscription.status === 'active') {
                <button
                  class="cyber-btn secondary"
                  (click)="cancelSubscription(false)"
                  [disabled]="isProcessing">
                  <span class="btn-text">ANNULER L'ABONNEMENT</span>
                </button>
              } @else if (subscription.status === 'cancelled') {
                <div class="cancelled-notice">
                  <span class="notice-icon">âš </span>
                  <span class="notice-text">Abonnement annulÃ© - Actif jusqu'au {{ subscriptionEndDate }}</span>
                </div>
                <button
                  class="cyber-btn primary"
                  (click)="reactivateSubscription()"
                  [disabled]="isProcessing">
                  <span class="btn-icon">â†»</span>
                  <span class="btn-text">RÃ‰ACTIVER</span>
                  <span class="btn-shine"></span>
                </button>
              }
            </div>
          </div>
        </div>
      }
    }
  </div>
</div>
