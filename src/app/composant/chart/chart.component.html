<div class="chart-wrapper">
  <!-- Terminal Header -->
  <div class="terminal-header">
    <span class="prompt">$</span>
    <span class="command">cat /var/log/metrics</span>
  </div>

  <!-- État de chargement -->
  @if (isLoading) {
    <div class="loading-state">
      <div class="terminal-loading">
        <span class="status-prefix">[...]</span>
        <span class="status-text">fetching data</span>
        <span class="cursor">_</span>
      </div>
    </div>
  }

  <!-- État d'erreur -->
  @if (error && !isLoading) {
    <div class="error-state">
      <div class="terminal-error">
        <span class="status-prefix">[ERR]</span>
        <span class="status-text">{{ error }}</span>
      </div>
      <button (click)="refreshData()" class="retry-button">
        retry
      </button>
    </div>
  }

  <!-- Contenu principal (graphique et filtres) -->
  @if (!isLoading && !error) {
    <div class="chart-content">
      <!-- Terminal Status OK -->
      <div class="terminal-status">
        <span class="status-prefix ok">[OK]</span>
        <span class="status-text">data loaded</span>
      </div>

      <!-- Filtres style CLI -->
      <div class="filter-container">
        <label for="yearFilter">--year</label>
        <select id="yearFilter" (change)="onYearChange($event)">
          <option value="animation">2015-2025 (animation)</option>
          <option value="2025">2025</option>
          <option value="2024">2024</option>
          <option value="2023">2023</option>
          <option value="2022">2022</option>
          <option value="2021">2021</option>
          <option value="2020">2020</option>
          <option value="2019">2019</option>
          <option value="2018">2018</option>
          <option value="2017">2017</option>
          <option value="2016">2016</option>
          <option value="2015">2015</option>
        </select>
      </div>

      <!-- Graphique -->
      <div class="chart-container">
        <canvas id="languageChart"></canvas>
      </div>

      <!-- Sources -->
      <div class="sources-section">
        <div class="sources-header">
          <span class="comment"># sources</span>
        </div>
        <div id="sources-container"></div>
      </div>

      <!-- Bouton de rafraîchissement -->
      <div class="refresh-button-container">
        <button (click)="refreshData()" class="refresh-button">
          <span class="prompt">$</span> refresh --force
        </button>
      </div>
    </div>
  }
</div>
